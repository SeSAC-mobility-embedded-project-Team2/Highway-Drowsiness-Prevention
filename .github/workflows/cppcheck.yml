name: Cppcheck Security Dashboard

on: [push, pull_request]

jobs:
  cppcheck-sarif:
    runs-on: ubuntu-latest
    permissions:
      security-events: write # [필수] 보안 탭에 리포트를 기록할 권한
      actions: read
      contents: read

    steps:
      # 1. 소스 코드 가져오기
      - uses: actions/checkout@v4

      # 2. Cppcheck 실행 및 SARIF 변환 (액션 활용)
      - name: Run Cppcheck
        uses: artemnovichkov/cppcheck-sarif@v1
        with:
          paths: .  # 현재 폴더 검사
          # exclude: Drivers/ # (옵션) 제외할 폴더가 있다면 주석 해제 후 입력

      # 3. GitHub Security 탭에 결과 업로드
      - name: Upload SARIF file
        uses: github/codeql-action/upload-sarif@v3
        with:
          sarif_file: cppcheck-result.sarif